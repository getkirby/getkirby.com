Title: Fixes
----

Text:

## Core
- The `$field->replace()` method no longer returns the model ID for empty fields, instead an empty string is returned as expected. [#3652](https://github.com/getkirby/kirby/issues/3652)
- Changing the template of a page on a multi-language setup no longer creates content files for untranslated languages. [#3674](https://github.com/getkirby/kirby/issues/3674)
- `User::changeEmail()` and `System::register()` now convert the provided email address to lowercase for better reliability [#3307](https://github.com/getkirby/kirby/pull/3307)
- `Str::accepted` always returns a float as `quality` value (before default `1` as int, all actual quality values as string, e.g. `'0.7'`) [#3393](https://github.com/getkirby/kirby/pull/3393)
- `Str::pool()`: the passed `$type` parameter is now treated case-insensitively [#3393](https://github.com/getkirby/kirby/pull/3393)
- `Str::pool()` now also returns a string (if set via the second argument) if an array of types is passed as  first argument [#3393](https://github.com/getkirby/kirby/pull/3393)
- Fixed return type for `Kirby\Cms\App::translation()` in DocBlock [#3383](https://github.com/getkirby/kirby/pull/3383)
- Fixed `tc()` helper docblock and parameter typing [#3474](https://github.com/getkirby/kirby/issues/3474)
- Database: Fixed inconsistent return types between the `Query` class insert method and shortcut `Db::$queries['insert']` [#3140](https://github.com/getkirby/kirby/issues/3140)
- Database: Fixed inner join queries [#2501](https://github.com/getkirby/kirby/issues/2501)
- Changing the slug of a page with an irrelevant `.lock` file no longer causes PHP to completely hang [#2516](https://github.com/getkirby/kirby/issues/2516)
- Fixed unstable links / hashes for media files [#3646](https://github.com/getkirby/kirby/issues/3646)
- It's no longer possible to switch from draft to unlisted page if there are page errors [#3781](https://github.com/getkirby/kirby/issues/3781)
- Fixed filename collision for cropped image files [#3418](https://github.com/getkirby/kirby/issues/3418)
- Hidden blocks are no longer visible in layouts [#3857](https://github.com/getkirby/kirby/issues/3857)
- The `image/svg` MIME type is now recognized by the `Sane` classes


## Panel
- The Panel now sets the correct default language in multi language projects: [#3647](https://github.com/getkirby/kirby/issues/3647)
- Changing the page title no longer causes errors with slug autocorrection (e.g. from underscores to dashes) if the user does not have permissions to change the slug
- Video block does now show domain-restricted clips in Panel [#3257](https://github.com/getkirby/kirby/issues/3257)
- Fixed manual files sorting via changePosition dialog [#3589](https://github.com/getkirby/kirby/issues/3589)
- `cover` option fixed for all models and list layout in section [#3226](https://github.com/getkirby/kirby/issues/3226)
- Fixed jump to the top of the page at ESC keydown in an overlay [#3387](https://github.com/getkirby/kirby/issues/3387)
- Fixed blocks field sort handle on hover [#3538](https://github.com/getkirby/kirby/issues/3538)
- Fixed writer field RTL support [idea 322](https://kirby.nolt.io/322)
- Fixed version number in settings view in RTL interface [#3581](https://github.com/getkirby/kirby/pull/3581)
- `this.$helper.upload` now correctly uses the method parameter
- Fixed writer field email title [#3630](https://github.com/getkirby/kirby/issues/3630)
- Fixed autofocus option for the blocks field [#3681](https://github.com/getkirby/kirby/pull/3681)
- `k-progress`: fixed not updating when value prop changed
- Fixed opening blocks that have no fields or are not editable [#3686](https://github.com/getkirby/kirby/pull/3686)
- Fix overlay/dialogs/drawers on back navigation [#3704](https://github.com/getkirby/kirby/issues/3651)
- Login with invalid password now sends a HTTP 401 in debug mode [#2856](https://github.com/getkirby/kirby/issues/2856)
- Added fallbacks for deprecated CSS classes [#3706](https://github.com/getkirby/kirby/issues/3706)
- Confirming an empty password dialog no longer throws an error [#3716](https://github.com/getkirby/kirby/issues/3716)
- Support for multi-line tags [#3614](https://github.com/getkirby/kirby/issues/3614)
- Fixed saving nested structure fields when the nested OK button was not clicked [#2550](https://github.com/getkirby/kirby/issues/2550)
- Top-level pages with a slug called `files` will no longer create havoc [#3187](https://github.com/getkirby/kirby/issues/3187)
- Fixed parsing logic for entire documents and breaks when pasting blocks [#3735](https://github.com/getkirby/kirby/issues/3735)
- The expired `DST Root CA X3` CA certificate (previously used for Let's Encrypt certificates) has been removed from the CA bundle to prevent "expired certificate" warnings when requesting remote resources (like in options API fields) on some server systems [#3765](https://github.com/getkirby/kirby/pull/3765)
- Fixed layout issue in the mobile version of the settings view [#3789](https://github.com/getkirby/kirby/pull/3789)
- Fixed multiline placeholder for writer field [#3470](https://github.com/getkirby/kirby/issues/3470)
- Account files are now fully accessible through the account view, even if permissions for the users area is blocked. [#2580](https://github.com/getkirby/kirby/issues/2580)
- Fixed nested blocks drawer breadcrumb issue [#3871](https://github.com/getkirby/kirby/issues/3871)
- Fix rotating loader in Firefox
