export default class{constructor(){this.init()}async init(){await import("../libraries/prism.js"),this.initPrism(),this.initClipboard(),new MutationObserver(this.highlight).observe(document.documentElement,{childList:!0,subtree:!0,attributes:!1,characterData:!1}),this.highlight()}initPrism(){Prism.languages.kirbytext=Prism.languages.extend("markdown",{}),Prism.languages.insertBefore("kirbytext","prolog",{kirbytag:{pattern:/\([a-z0-9_-]+:.*?\)/i,inside:{"kirbytag-bracket":/^\(|\)$/,"kirbytag-name":{pattern:/^[a-z0-9_-]+:/i},"kirbytag-attr":{pattern:/([^:]\s+)[a-z0-9_-]+:/i,lookbehind:!0}}}}),Prism.languages.kirbycontent={delimiter:/\n----\s*\n*/,property:{pattern:/(^\n*|\n----\s*\n*)[a-zA-Z0-9_\-\u0020]+:/,lookbehind:!0}},Prism.plugins.customClass.prefix("code-")}initClipboard(){Prism.plugins.toolbar.registerButton("copy-to-clipboard",function(t){var e=document.createElement("a");e.classList.add("link-reset"),e.insertAdjacentHTML("beforeend",'<svg viewBox="0 0 16 16" width="16" height="16" class="icon"><path d="M10,4H2C1.4,4,1,4.4,1,5v10c0,0.6,0.4,1,1,1h8c0.6,0,1-0.4,1-1V5C11,4.4,10.6,4,10,4z"></path> <path data-color="color-2" d="M14,0H4v2h9v11h2V1C15,0.4,14.6,0,14,0z"></path></svg>');var a=document.createElement("span");return a.textContent="Copy",e.appendChild(a),e.addEventListener("click",async function(e){const{default:i}=await import("../libraries/clipboard.js");try{await i(t.code),a.textContent="Copied!"}catch(t){a.textContent="Press Ctrl+C/âŒ˜+C to copy"}finally{setTimeout(()=>{a.textContent="Copy"},5e3)}}),e})}highlight(){const t=document.querySelectorAll('pre code[class^="language-"], pre code[class*=" language-"], pre.code > code'),e=/(?:^| )language(-[a-z])( |$)*/i;for(let a,i=0,n=t.length;i<n&&(a=t[i]);i++)e.test(a.className)||a.classList.add("language-plaintext");const a=document.getElementsByTagName("code");for(let t=0,e=a.length;t<e;t++){const e=a[t],i=e.parentElement;"PRE"===i.tagName&&(i.className.match(/(^|\b)language-([^\b]|$)/)||Prism.highlightElement(e))}}}